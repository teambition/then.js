/**
 * thenjs: v1.3.7
 * https://github.com/teambition/then.js
 */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.Thenjs=b()}("object"==typeof window?window:this,function(){"use strict";function a(a,b){var c=a.length,d=Array(c);for(b=b||0;c-->b;)d[c-b]=a[c];return d}function b(b,c){try{c.apply(null,a(arguments,2))}catch(d){b(d)}}function c(b,c){var d=a(arguments,2);t(function(){try{c.apply(null,d)}catch(a){b(a)}})}function d(a,b){var c,e=this;if(a instanceof d)return a;if(!(e instanceof d))return new d(a,b);if(e._success=e._each=e._eachSeries=e._parallel=e._series=null,e._finally=e._error=e._fail=e._result=e._nextThen=e._chain=null,!arguments.length)return e;c=h(e,b);try{"function"==typeof a?a(c):null==a?c():"function"==typeof a.toThunk?a.toThunk()(c):"function"==typeof a.then?a.then(function(a){c(null,a)},c):c(null,a)}catch(f){c(f)}}function e(b){var c=this,d=arguments;if(c._result!==!1){!c._result&&c._chain&&c.debug.apply(c,["\nChain "+c._chain+": "].concat(a(d))),c._result=!1;try{f(c,d,b)}catch(e){t(function(){g(c,e,b)})}}}function f(b,c,d){if(b._finally)return b._finally.apply(null,c);if(null!=d)throw d;var e=b._success||b._each||b._eachSeries||b._parallel||b._series;return e?e.apply(null,a(c,1)):void(b._result=c)}function g(a,b,c){var e=a,f=a._error||a._fail;for(a._nextThen&&null==c&&(f=null,e=a._nextThen);!f&&e;)f=e._fail,e=e._nextThen;return f?f(b):d.onerror?d.onerror(b):void(e._result=[b])}function h(a,b){function c(){return e.apply(a,arguments)}return c._isCont=!0,b&&(v.debug="function"==typeof b?b:p,a._chain=1),c}function i(a,b,c){var f=new d,g=h(f,c);return a(g,b),b?(b._nextThen=f,b._chain&&(f._chain=b._chain+1),b._result&&t(function(){e.apply(b,b._result)}),f):f}function j(b,c){return c._isCont?c:function(){c.apply(null,[b].concat(a(arguments)))}}function k(a,b,c,d){function e(e,f){return c.finished?void 0:null!=e?(c.finished=!0,a(e)):(b[d]=f,--c.i<0&&a(null,b))}return e._isCont=!0,e}function l(a,b,c){var d,e=[],f={};if(!u(b))return a(q(b,"each"));if(f.i=d=b.length-1,0>d)return a(null,e);for(var g=0;d>=g;g++)c(k(a,e,f,g),b[g],g,b)}function m(a,b){var c,d=[],e={};if(!u(b))return a(q(b,"parallel"));if(e.i=c=b.length-1,0>c)return a(null,d);for(var f=0;c>=f;f++)b[f](k(a,d,e,f),f,b)}function n(a,d,e){function f(l,m){return null!=l?a(l):(j[i]=m,++i>g?a(null,j):(h=--k>0?b:(k=r,c),void h(a,e,f,d[i],i,d)))}var g,h,i=0,j=[],k=r;return f._isCont=!0,u(d)?(g=d.length-1,0>g?a(null,j):void e(f,d[0],0,d)):a(q(d,"eachSeries"))}function o(a,d){function e(k,l){return null!=k?a(k):(i[h]=l,++h>f?a(null,i):(g=--j>0?b:(j=r,c),void g(a,d[h],e,h,d)))}var f,g,h=0,i=[],j=r;return e._isCont=!0,u(d)?(f=d.length-1,0>f?a(null,i):void d[0](e,0,d)):a(q(d,"series"))}function p(){console.log.apply(console,arguments)}function q(a,b){return new Error("The argument "+(a&&a.toString())+' in "'+b+'" is not Array!')}var r=100,s=Object.prototype.toString,t="function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},u=Array.isArray||function(a){return"[object Array]"===s.call(a)};d.defer=c,d.each=function(a,b,d){return i(function(d){c(d,l,d,a,b)},null,d)},d.eachSeries=function(a,b,d){return i(function(d){c(d,n,d,a,b)},null,d)},d.parallel=function(a,b){return i(function(b){c(b,m,b,a)},null,b)},d.series=function(a,b){return i(function(b){c(b,o,b,a)},null,b)},d.nextTick=function(b){var c=a(arguments,1);t(function(){b.apply(null,c)})},d.onerror=function(a){throw console.error("Thenjs caught error: ",a),a};var v=d.prototype;return v.fin=v.all=v["finally"]=function(a){return i(function(b,c){c._finally=j(b,a)},this)},v.then=function(a,b){return i(function(c,d){d._success=j(c,a),d._error=b&&j(c,b)},this)},v.fail=v["catch"]=function(b){return i(function(c,d){d._fail=j(c,b),d._success=function(){c.apply(null,[null].concat(a(arguments)))}},this)},v.each=function(a,b){return i(function(c,d){d._each=function(d,e){l(c,a||d,b||e)}},this)},v.eachSeries=function(a,b){return i(function(c,d){d._eachSeries=function(d,e){n(c,a||d,b||e)}},this)},v.parallel=function(a){return i(function(b,c){c._parallel=function(c){m(b,a||c)}},this)},v.series=function(a){return i(function(b,c){c._series=function(c){o(b,a||c)}},this)},v.toThunk=function(){var a=this;return function(b){a._result?(b.apply(null,a._result),a._result=!1):a._result!==!1&&(a._finally=b)}},d.NAME="Thenjs",d.VERSION="1.3.7",d});