/**
 * thenjs: v0.10.1
 * https://github.com/teambition/then.js
 */
"use strict";!function(){function a(a){return null==a}function b(a){return"function"==typeof a}function c(a,b,c){return new Error("Argument "+(a&&a.toString())+' in "'+b+'" function is not a '+c+"!")}function d(d,e,f,g){function h(b,c,e){return k-=1,a(c)?(m[b]=e,0>=k?d(null,m):void 0):d(c)}var i,j,k,l,m=[];if(!p(e))return d(c(e,"each","array"));if(!b(f))return d(c(f,"each","function"));if(k=j=e.length,!k)return d(null,m);for(i=0;j>i;i++)l=h.bind(null,i),l.nextThenObject=n,f.call(g,l,e[i],i,e)}function e(d,e,f,g){function h(b,c){return j+=1,a(b)?(k[j-1]=c,i>j?f.call(g,h,e[j],j,e):(delete k[-1],d(null,k))):d(b)}var i,j=-1,k=[];return p(e)?b(f)?(i=e.length,i?(h.nextThenObject=n,h()):d(null,k)):d(c(f,"eachSeries","function")):d(c(e,"eachSeries","array"))}function f(d,e,f){function g(b,c,e){return j-=1,a(c)?(l[b]=e,0>=j?d(null,l):void 0):d(c)}var h,i,j,k,l=[];if(!p(e))return d(c(e,"parallel","array"));if(j=i=e.length,!j)return d(null,l);for(h=0;i>h;h++){if(!b(e[h]))return d(c(e[h],"parallel","function"));k=g.bind(null,h),k.nextThenObject=n,e[h].call(f,k,h)}}function g(d,e,f){function g(k,l){return i+=1,a(k)?(j[i-1]=l,h>i?b(e[i])?e[i].call(f,g,i):d(c(e[i],"series","function")):(delete j[-1],d(null,j))):d(k)}var h,i=-1,j=[];return p(e)?(h=e.length,h?(g.nextThenObject=n,g()):d(null,j)):d(c(e,"series","array"))}function h(a,b){q(function(){try{b()}catch(c){a(c)}})}function i(a,c){return b(c)?c.nextThenObject?c:c.bind(null,a):null}function j(c){function h(a,b){var c=new n,d=c.defer.bind(c);return d.nextThenObject=c,a(d,b),c}function j(a){a._result&&a.defer.apply(a,a._result)}var k=[],l=0,n=function(){},p=n.prototype;return p.debug=!c||b(c)?c:"object"==typeof console&&console.log&&function(){console.log.apply(console,arguments)},p.all=function(a){return h(function(b,c){c._all=i(b,a),j(c)},this)},p.then=function(a,b){return h(function(c,d){d._success=i(c,a),d._error=i(c,b),j(d)},this)},p.fail=function(a){return h(function(b,c){c._fail=i(b,a),c._success=b.bind(b,null),c._fail&&k.push(c._fail),j(c)},this)},p.each=function(a,b,c){return h(function(e,f){f._each=function(f,g,h){d(e,a||f,b||g,c||h)},j(f)},this)},p.eachSeries=function(a,b,c){return h(function(d,f){f._eachSeries=function(f,g,h){e(d,a||f,b||g,c||h)},j(f)},this)},p.parallel=function(a,b){return h(function(c,d){d._parallel=function(d,e){f(c,a||d,b||e)},j(d)},this)},p.series=function(a,b){return h(function(c,d){d._series=function(d,e){g(c,a||d,b||e)},j(d)},this)},p.defer=function(b){function c(){if(e.debug){var c=o.call(f);c.unshift("\nResult of chain "+l+":"),e.debug.apply(e.debug,c)}if(e._all)e._all.apply(e._all.nextThenObject,o.call(f));else{if(!a(b))throw b;e._success.apply(e._success.nextThenObject,o.call(f,1))}}function d(a){a.stack=a.stack||a.description,e._error||k.length?(e._error=e._error||k.shift(),e._error.call(e._error.nextThenObject,a)):m.onerror?m.onerror(a):e._result=f}var e=this,f=arguments;if(e._result!==!1){e._error=e._fail?k.shift():e._error,e._success=e._success||e._each||e._eachSeries||e._parallel||e._series||function(){e._result=f};try{c()}catch(g){d(g)}finally{e._result||(l+=1,e._result=!1)}}},h}function k(a){return function(b,c,d,e){return j(e)(function(e){h(e,a.bind(null,e,b,c,d))})}}function l(a){return function(b,c,d){return j(d)(function(d){h(d,a.bind(null,d,b,c))})}}function m(a,c,d){return j(d)(function(d){h(d,b(a)?a.bind(c,d):d)})}var n={},o=[].slice,p=Array.isArray,q="object"==typeof process&&process.nextTick?process.nextTick:setTimeout;m.each=k(d),m.eachSeries=k(e),m.parallel=l(f),m.series=l(g),"object"==typeof module&&"object"==typeof module.exports?module.exports=m:"function"==typeof define&&define.amd?define([],function(){return m}):"object"==typeof window&&(window.then=m)}();